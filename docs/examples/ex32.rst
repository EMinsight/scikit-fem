.. _blockstokes

Block diagonally preconditioned Stokes solver
---------------------------------------------

.. note::

   This examples requires the external packages `pygmsh
   <https://pypi.org/project/pygmsh/>`_ and `pyamg
   <https://pypi.org/project/pyamg/>`_.

.. note::

   This example is a stub. You could help us to improve it; see :ref:`contribute`.

This example again solves the Stokes problem, but this time in three dimensions, with an algorithm that scales to reasonably fine meshes (a million tetrahedra in a few minutes).

.. literalinclude:: ex32.py
   :linenos:

*  Elman, H. C., Silvester, D. J.,, Wathen, A. J. (2014). *Finite Elements and Fast Iterative Solvers : with Applications in Incompressible Fluid Dynamics*, ch. 4 'Solution of discrete Stokes problems'.  Oxford University Press.  `doi:10.1093/acprof:oso/9780199678792.001.0001 <https://doi.org/10.1093%2facprof:oso%2f9780199678792.001.0001>`_
*  McBain, G. D. (2016). `Creeping convection in a horizontally heated ellipsoid <http://people.eng.unimelb.edu.au/imarusic/proceedings/20/548/%20Paper.pdf>`_. *Proceedings of the Twentieth Australasian Fluid Mechanics Conference*.
